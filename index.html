<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>–ü–æ—Ç—É–∂–Ω–æ–º–µ—Ç—Ä</title>
<style>
body {
  margin: 0;
  font-family: 'Arial', sans-serif;
  background: linear-gradient(to bottom, #1f1c2c, #928dab);
  color: white;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  touch-action: manipulation;
}

header { text-align: center; padding: 15px 10px; text-shadow: 0 0 15px #00ffd5; }
h1 { font-size: 2em; margin:0; }

main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 15px; }

#power-container {
  width: 90%; max-width: 500px; height: 35px; background: #2b2b3b; margin: 20px 0;
  border-radius: 20px; overflow: hidden; box-shadow: inset 0 0 15px #000;
}

#power-bar {
  height: 100%; width: 0%; background: #00ffd5; border-radius: 20px; transition: width 1s, background 0.5s;
}

.stats { display: flex; justify-content: space-between; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
.stats div { font-size: 1em; padding: 8px 12px; background: rgba(255,255,255,0.05); border-radius: 12px; transition: transform 0.2s, background 0.3s; flex: 1 1 30%; text-align: center; }
.stats div:hover { transform: scale(1.05); background: rgba(255,255,255,0.15); }

button {
  background: linear-gradient(135deg, #ff6ec4, #7873f5);
  color: white; border: none; padding: 12px 25px; font-size: 1em; border-radius: 12px; cursor: pointer;
  margin: 8px; box-shadow: 0 0 15px rgba(255,110,196,0.6); transition: transform 0.2s, box-shadow 0.3s;
}
button:hover { transform: translateY(-2px); box-shadow: 0 0 25px rgba(255,110,196,0.9); }

#mood-text { font-size: 1.2em; margin-top: 8px; transition: color 0.5s; text-align: center; }

footer {
  background: #2b2b3b; display: flex; justify-content: space-around; padding: 12px 0; box-shadow: 0 -5px 15px rgba(0,0,0,0.5);
}
footer button { flex: 1; margin: 0 5px; font-size: 1em; transition: transform 0.2s, background 0.3s; }
footer button:hover { transform: translateY(-2px); }

section { display: none; width: 100%; max-width: 600px; }
section.active { display: block; animation: fadeIn 0.5s ease-in-out; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

table { width: 100%; border-collapse: collapse; margin-top: 15px; color: white; font-size: 0.9em; }
th, td { padding: 8px; border: 1px solid #fff; text-align: center; }
th { background-color: #ff6ec4; color: white; }
td { background-color: rgba(255,255,255,0.1); }
</style>
</head>
<body>

<header><h1>üî• –ü–æ—Ç—É–∂–Ω–æ–º–µ—Ç—Ä üî•</h1></header>

<main>
<!-- –†–∞–∑–¥–µ–ª –ì—Ä–∞ -->
<section id="game-section" class="active">
  <div id="power-container"><div id="power-bar"></div></div>
  <div class="stats">
    <div>–†–µ–∑—É–ª—å—Ç–∞—Ç: <span id="power-value">0</span></div>
    <div>–û—á–∫–∏: <span id="points-value">0</span></div>
    <div>–ï–Ω–µ—Ä–≥—ñ—è: <span id="energy-value">50</span></div>
  </div>
  <div id="mood-text">–Ø —Å—É–º–Ω–∏–π üòî</div>
  <button id="measure-btn" onclick="measurePower()">–í–∏–º—ñ—Ä—è—Ç–∏ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å</button>
  <button onclick="upgrade('energy')">–ü—Ä–æ–∫–∞—á–∞—Ç–∏ –µ–Ω–µ—Ä–≥—ñ—é (10 –æ—á–æ–∫)</button>
</section>

<!-- –†–∞–∑–¥–µ–ª –ú–∞–≥–∞–∑–∏–Ω -->
<section id="shop-section">
  <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
  <p>–¢—É—Ç –º–æ–∂–Ω–∞ –∫—É–ø–∏—Ç–∏ –±–æ–Ω—É—Å–∏ –∞–±–æ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–∞ –æ—á–∫–∏.</p>
  <button onclick="buyItem('bonus1',5)">–ö—É–ø–∏—Ç–∏ –±–æ–Ω—É—Å 1 (5 –æ—á–æ–∫)</button>
  <button onclick="buyItem('bonus2',10)">–ö—É–ø–∏—Ç–∏ –±–æ–Ω—É—Å 2 (10 –æ—á–æ–∫)</button>
</section>

<!-- –†–∞–∑–¥–µ–ª –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<section id="stats-section">
  <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
  <div id="high-score">–ù–∞–π–≤–∏—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <span id="high-score-value">0</span></div>
  <h3>–¢–∞–±–ª–∏—Ü—è –ª—ñ–¥–µ—Ä—ñ–≤</h3>
  <table id="leaderboard">
    <thead><tr><th>–ú—ñ—Å—Ü–µ</th><th>–Ü–º'—è</th><th>–û—á–∫–∏</th></tr></thead>
    <tbody></tbody>
  </table>
</section>
</main>

<footer>
  <button onclick="switchSection('game-section')">–ì—Ä–∞</button>
  <button onclick="switchSection('shop-section')">–ú–∞–≥–∞–∑–∏–Ω</button>
  <button onclick="switchSection('stats-section')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
</footer>

<script>
// –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
let points = parseInt(localStorage.getItem("points")) || 0;
let energy = parseInt(localStorage.getItem("energy")) || 50;
let highScore = parseInt(localStorage.getItem("highScore")) || 0;
let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
let measureCount = 0;
let lastReset = Date.now();

// –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
const tg = window.Telegram?.WebApp;
const username = tg?.initDataUnsafe?.user?.username || tg?.initDataUnsafe?.user?.first_name || "–ì—Ä–∞–≤–µ—Ü—å";

document.getElementById("points-value").innerText = points;
document.getElementById("energy-value").innerText = energy;
document.getElementById("high-score-value").innerText = highScore;

// –ê–Ω–∏–º–∞—Ü–∏—è —á–∏—Å–ª–∞
function animateValue(id, start, end, duration){
  let range = end - start;
  let current = start;
  let increment = range / (duration/20);
  let obj = document.getElementById(id);
  let timer = setInterval(()=>{
    current += increment;
    if((increment>0 && current>=end)||(increment<0 && current<=end)){ current=end; clearInterval(timer);}
    obj.innerText=Math.floor(current);
  },20);
}

// –õ–æ–≥–∏–∫–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è –º–æ—â–Ω–æ—Å—Ç–∏
function measurePower(){
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞
  const now = Date.now();
  if(now - lastReset > 5*60*1000){ measureCount=0; lastReset=now; }
  if(measureCount>=10){ alert("–ú–æ–∂–Ω–∞ –≤–∏–º—ñ—Ä—é–≤–∞—Ç–∏ –Ω–µ –±—ñ–ª—å—à–µ 10 —Ä–∞–∑—ñ–≤ –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω!"); return; }
  measureCount++;

  const value = Math.floor(Math.random()*9999)+1;
  const bar = document.getElementById("power-bar");
  const percent = Math.min(value/9999*100,100);
  bar.style.width=percent+"%";

  if(value<1000) bar.style.background="#00ffd5";
  else if(value<5000) bar.style.background="#ffe600";
  else if(value<9000) bar.style.background="#ff6ec4";
  else bar.style.background="#ff3c3c";

  animateValue("power-value",0,value,1000);

  const earnedPoints = Math.floor(value/100);
  points += earnedPoints;
  document.getElementById("points-value").innerText=points;

  if(value>highScore){
    highScore=value;
    document.getElementById("high-score-value").innerText=highScore;
    localStorage.setItem("highScore",highScore);
  }

  localStorage.setItem("points",points);
  localStorage.setItem("energy",energy);

  addToLeaderboard(points);
  updateMood();
}

// –õ–æ–≥–∏–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞
function buyItem(item,cost){
  if(points<cost){ alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –æ—á–æ–∫!"); return; }
  points -= cost;
  localStorage.setItem("points",points);
  document.getElementById("points-value").innerText=points;

  if(item==='bonus1'){ energy +=5; energy=Math.min(100,energy); localStorage.setItem("energy",energy); document.getElementById("energy-value").innerText=energy; }
  if(item==='bonus2'){ energy +=10; energy=Math.min(100,energy); localStorage.setItem("energy",energy); document.getElementById("energy-value").innerText=energy; }

  updateMood();
}

// –ü—Ä–æ–∫–∞—á–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏
function upgrade(type){
  if(points<10){ alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –æ—á–æ–∫!"); return; }
  points-=10;
  localStorage.setItem("points",points);
  document.getElementById("points-value").innerText=points;

  if(type==='energy'){ energy+=10; energy=Math.min(100,energy); localStorage.setItem("energy",energy); document.getElementById("energy-value").innerText=energy; }

  updateMood();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
function updateMood(){
  const moodText=document.getElementById("mood-text");
  if(energy<30) moodText.innerText="–Ø —Å—É–º–Ω–∏–π üòî";
  else if(energy<70) moodText.innerText="–Ø —â–∞—Å–ª–∏–≤–∏–π üôÇ";
  else moodText.innerText="–Ø –¥—É–∂–µ —â–∞—Å–ª–∏–≤–∏–π üòÑ";
}

// –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
function addToLeaderboard(score){
  leaderboard.push({name:username,score:score});
  leaderboard.sort((a,b)=>b.score-a.score);
  leaderboard=leaderboard.slice(0,10);
  localStorage.setItem("leaderboard",JSON.stringify(leaderboard));
  renderLeaderboard();
}

function renderLeaderboard(){
  const tbody=document.getElementById("leaderboard").querySelector("tbody");
  tbody.innerHTML="";
  leaderboard.forEach((item,index)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${index+1}</td><td>${item.name}</td><td>${item.score}</td>`;
    tbody.appendChild(tr);
  });
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤
function switchSection(sectionId){
  document.querySelectorAll('section').forEach(sec=>sec.classList.remove('active'));
  document.getElementById(sectionId).classList.add('active');
  if(sectionId==='stats-section') renderLeaderboard();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
updateMood();
renderLeaderboard();
</script>
</body>
</html>
